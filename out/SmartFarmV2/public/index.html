<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartFarm</title>
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåæ</text></svg>">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Night Cycle Overlay -->
    <div id="nightOverlay" class="night-overlay"></div>

    <div class="app-container">
        
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="logo-section">
                <span class="logo-icon">üåæ</span>
                <div class="logo-text">
                    <h1>SmartFarm V2</h1>
                </div>
            </div>

            <nav class="nav-menu">
                <a href="#overview" class="nav-item active">
                    <span>üìä</span> Dashboard
                </a>
                <a href="#market" class="nav-item">
                    <span>üõí</span> Market
                </a>
                <a href="#agents" class="nav-item">
                    <span>ü§ñ</span> Agents
                </a>
                <a href="#logs" class="nav-item">
                    <span>üìú</span> System Logs
                </a>
            </nav>

            <div class="status-panel mt-auto">
                <div class="connection-status">
                    <span id="statusDot" class="status-dot disconnected"></span>
                    <span id="statusText">Disconnected</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            
            <!-- Top Header -->
            <header class="top-header">
                <h2 class="header-title">Live Control Panel</h2>
                <div class="header-stats">
                    <div class="stat-item" id="timeDisplay">
                        <span class="stat-label">Time:</span> 
                        <span id="gameTime">06:00</span>
                    </div>
                    <div class="stat-item" id="weatherDisplay">
                        <span class="stat-label">Weather:</span> ‚òÄÔ∏è Sunny
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Funds:</span> 
                        <span id="moneyDisplay">$0</span>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-wrapper">
                
                <!-- TAB: OVERVIEW -->
                <div id="overview" class="tab-pane active">
                    <div class="dashboard-grid" id="farmGrid">
                        
                        <!-- Base -->
                        

                        <!-- Warehouse -->
                        <div class="card card-warehouse">
                            <div class="card-header">
                                <span class="card-title">üì¶ Warehouse</span>
                            </div>
                            <div id="warehouseStats" style="font-size: 0.85rem; display:flex; flex-direction:column; gap:0.3rem;">
                                <!-- Dynamic Content -->
                                Loading inventory...
                            </div>
                        </div>

                        <!-- Market -->
                        <div class="card card-market">
                            <div class="card-header">
                                <span class="card-title">üí∞ Global Market</span>
                            </div>
                            <div style="font-size: 0.85rem;">
                                <div style="display:flex; justify-content:space-between;">
                                    <span>Water:</span> <span style="color:var(--accent-green)">$5</span>
                                </div>
                                <div style="display:flex; justify-content:space-between;">
                                    <span>Fungicide:</span> <span style="color:var(--accent-green)">$20</span>
                                </div>
                            </div>
                        </div>

                        <!-- Clients -->
                        <div class="card card-clients">
                            <div class="card-header">
                                <span class="card-title">üë• Clients</span>
                            </div>
                            <div style="font-size: 0.85rem;">
                                <p>Crop Buyers Active</p>
                            </div>
                        </div>

                        <!-- Field 1 -->
                        <div class="card card-field" id="field-1">
                            <div class="card-header">
                                <span class="card-title">üå± Field 1</span>
                                <div id="status-badges-1" style="display:flex; gap:0.5rem"></div>
                            </div>
                            
                            <!-- Empty State -->
                            <div id="empty-field-1" class="action-btn-lg" onclick="plantField(1)" style="display:none">
                                <span class="action-icon">‚ûï</span>
                                <span>Plant Crop ($500)</span>
                            </div>

                            <!-- Active State -->
                            <div id="active-field-1" class="field-content">
                                <div class="field-header">
                                    <div class="field-info">
                                        <h3><span id="crop-icon-1">üå±</span> <span id="crop-name-1">Corn</span></h3>
                                    </div>
                                    <div class="workers-container" id="workers-1"></div>
                                </div>

                                <div class="farm-stats">
                                    <div class="stat-group">
                                        <div class="stat-bar-header">
                                            <span>üíß Moisture</span>
                                            <span id="val-moisture-1">0%</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="bar-moisture-1" class="progress-fill fill-moisture" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <div class="stat-group">
                                        <div class="stat-bar-header">
                                            <span>‚ù§Ô∏è Health</span>
                                            <span id="val-health-1">100%</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="bar-health-1" class="progress-fill fill-health" style="width: 100%"></div>
                                        </div>
                                    </div>
                                    <div class="stat-group">
                                        <div class="stat-bar-header">
                                            <span>üìà Growth</span>
                                            <span id="val-growth-1">0%</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="bar-growth-1" class="progress-fill fill-growth" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <div class="stat-group">
                                        <div class="stat-bar-header">
                                            <span>üîç Scan Level</span>
                                            <span id="val-scan-1">100%</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="bar-scan-1" class="progress-fill fill-scan" style="width: 100%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Field 2 -->
                        <div class="card card-field" id="field-2">
                            <div class="card-header">
                                <span class="card-title">üåæ Field 2</span>
                                <div id="status-badges-2" style="display:flex; gap:0.5rem"></div>
                            </div>

                            <!-- Empty State -->
                            <div id="empty-field-2" class="action-btn-lg" onclick="plantField(2)" style="display:none">
                                <span class="action-icon">‚ûï</span>
                                <span>Plant Crop ($500)</span>
                            </div>

                            <!-- Active State -->
                            <div id="active-field-2" class="field-content">
                                <div class="field-header">
                                    <div class="field-info">
                                        <h3><span id="crop-icon-2">üåæ</span> <span id="crop-name-2">Wheat</span></h3>
                                    </div>
                                    <div class="workers-container" id="workers-2"></div>
                                </div>
                                <div class="farm-stats">
                                    <div class="stat-group">
                                        <div class="stat-bar-header">
                                            <span>üíß Moisture</span>
                                            <span id="val-moisture-2">0%</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="bar-moisture-2" class="progress-fill fill-moisture" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <div class="stat-group">
                                        <div class="stat-bar-header">
                                            <span>‚ù§Ô∏è Health</span>
                                            <span id="val-health-2">100%</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="bar-health-2" class="progress-fill fill-health" style="width: 100%"></div>
                                        </div>
                                    </div>
                                    <div class="stat-group">
                                        <div class="stat-bar-header">
                                            <span>üìà Growth</span>
                                            <span id="val-growth-2">0%</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="bar-growth-2" class="progress-fill fill-growth" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <div class="stat-group">
                                        <div class="stat-bar-header">
                                            <span>üîç Scan Level</span>
                                            <span id="val-scan-2">100%</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="bar-scan-2" class="progress-fill fill-scan" style="width: 100%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>

                <!-- TAB: MARKET -->
                <div id="market" class="tab-pane">
                    <header class="tab-header">
                        
                        
                    </header>
                    
                    <div class="market-categories">
                        <button class="cat-btn active" onclick="filterMarket('ALL')">All</button>
                        <button class="cat-btn" onclick="filterMarket('LAND')">Real Estate</button>
                        <button class="cat-btn" onclick="filterMarket('EQUIPMENT')">Equipment</button>
                        <button class="cat-btn" onclick="filterMarket('RESOURCE')">Resources</button>
                    </div>

                    <div id="marketGrid" class="market-grid-v2">
                        <!-- Dynamic Injection -->
                    </div>
                </div>

                <!-- Purchase Confirmation Modal -->
                <div id="purchaseModal" class="modal-overlay">
                    <div class="modal">
                        <div class="modal-header">
                            <span class="modal-title">Confirm Purchase</span>
                            <button class="modal-close" onclick="closeModal('purchaseModal')">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="purchase-preview">
                                <div id="modalItemIcon" class="large-icon">üì¶</div>
                                <div class="purchase-details">
                                    <h3 id="modalItemName">Item Name</h3>
                                    <p id="modalItemDesc">Description goes here</p>
                                    <div class="purchase-price">
                                        <span>Cost:</span>
                                        <span id="modalItemPrice" class="price-tag">$0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="balance-check">
                                <div class="row">
                                    <span>Current Balance:</span>
                                    <span id="modalCurrentBalance">$0</span>
                                </div>
                                <div class="row new-balance">
                                    <span>After Purchase:</span>
                                    <span id="modalNewBalance">$0</span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeModal('purchaseModal')">Cancel</button>
                            <button id="confirmPurchaseBtn" class="btn btn-primary" onclick="executePurchase()">Confirm Payment</button>
                        </div>
                    </div>
                </div>

                <!-- TAB: AGENTS -->
                <div id="agents" class="tab-pane">
                    <h3 style="margin-bottom:1.5rem">Agent Status</h3>
                    <div id="agentsGrid" class="agents-grid">
                        <!-- Dynamic Agents will be injected here -->
                    </div>
                </div>

                <!-- TAB: LOGS -->
                <div id="logs" class="tab-pane">
                    <h3 style="margin-bottom:1.5rem">System Events</h3>
                    <div id="systemLogs" class="log-panel">
                        <!-- Logs injected here -->
                        <div class="log-entry"><span class="log-time">[System]</span> Waiting for logs...</div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Agent Status Monitor -->
    <div id="agent-monitor" class="agent-monitor"></div>

    <!-- Mini Logs Overlay -->
    <div id="miniLogs" class="mini-logs"></div>

    <!-- Main Logic -->
    <script src="main.js"></script>

</body>
</html>